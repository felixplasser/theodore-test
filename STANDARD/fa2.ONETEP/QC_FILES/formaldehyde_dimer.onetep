 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.3.1   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2021     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 28-07-2021 17:55 (+0100)

Reading parameters from file "formaldehyde_dimer.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      WARNING: Error getting the value of the OMP_NUM_THREADS environment variable.
      Not changing the default number of threads (risk of CPU oversubscription).
      Default threads: 1
   Running with 2 MPI processes.
   There are 2 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               1 threads for loops over batched FFT box operations.
               1 threads in other parallel regions.
... done

Basic input checks...
WARNING: lr_tddft_write_kernels overriden to T, as you have requested the output of MO coeffs to be turned on for the interface to TheoDORE.
... done

Reading geometry and species blocks from file "formaldehyde_dimer.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task singlepoint cond lr_tddft                                                  
cutoff_energy 600.0 eV                                                          
xc_functional pbe                                                               
maxit_ngwf_cg 120                                                               
minit_lnv 5                                                                     
maxit_lnv 10                                                                    
do_properties T                                                                 
output_mo_coeff T                                                               
cond_num_states : 16                                                            
lr_tddft_num_states : 5                                                         
%block species                                                                  
C C 6 4 8.0                                                                     
O O 8 4 8.0                                                                     
H H 1 1 8.0                                                                     
%endblock species                                                               
%block species_cond                                                             
C C 6 4 10.0                                                                    
O O 8 4 10.0                                                                    
H H 1 1 10.0                                                                    
%endblock species_cond                                                          
%block species_pot                                                              
C C_OTF.usp                                                                     
O O_OTF.usp                                                                     
H H_OTF.usp                                                                     
%endblock species_pot                                                           
%block lattice_cart                                                             
ang                                                                             
30.000000000       0.000000000       0.000000000                                
0.000000000      30.000000000       0.000000000                                 
0.000000000       0.000000000      30.000000000                                 
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =  -000005211816923505759732
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------



<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: C_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.19 bohr
  Core charge supplied for Nonlinear Core Corrections
File: O_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.19 bohr
  Core charge supplied for Nonlinear Core Corrections
File: H_OTF.usp [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Shell 1: l = 0; rc = 0.95 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms  Nvalngwfs Ncondngwfs  Nprojs
  C          2         8         8         2
  O          2         8         8         2
  H          4         4         4         4
.......   ......    ......    ......    ......
Totals:      8        20        20         8
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   99 x  99 x  99
                              FFT-box:   99 x  99 x  99
                                  PPD:    9 x   9 x   1
Grid space d1=  0.572644508416a0 (KE cutoff=  23.16508Eh = 630.35390eV)
Grid space d2=  0.572644508416a0 (KE cutoff=  23.16508Eh = 630.35390eV)
Grid space d3=  0.572644508416a0 (KE cutoff=  23.16508Eh = 630.35390eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     99    99    99
          Real-space ('12') slabs/proc (min max mean):     49    50    49
         Recip-space ('23') slabs/proc (min max mean):     25    25    25
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    198   198   198
          Real-space ('12') slabs/proc (min max mean):     99    99    99
         Recip-space ('23') slabs/proc (min max mean):     50    50    50
********************************************************************************

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  21 iterations to a total energy of     -5.59821767

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  24 iterations to a total energy of    -15.77876555

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  18 iterations to a total energy of     -0.45748195

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  21 iterations to a total energy of     -5.60176742

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  24 iterations to a total energy of    -15.77949291

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  18 iterations to a total energy of     -0.45863871

WARNING: lr_tddft_write_kernels overriden to T, as you have requested the output of MO coeffs to be turned on for the interface to TheoDORE.

Determining parallel strategy ...... done
Calculating Ewald energy ...           42.533498 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done
NGWF initialisation ...... done
Up spin density kernel initialisation ...... done

Writing density kernel to file "formaldehyde_dimer.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.509683543726E+01     2.0709E-02     1.7258E-02
    2        -4.512459643638E+01     6.5449E-03     5.4540E-03    -2.7761E-02
    3        -4.512763813941E+01     1.6967E-03     1.4139E-03    -3.0417E-03
    4        -4.512796059552E+01     5.0907E-04     4.2422E-04    -3.2246E-04
    5        -4.512798627447E+01     2.5490E-04     2.1242E-04    -2.5679E-05
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.51279862744682E+01  Eh
     Estimated bandgap           =   1.0736E-01  Eh
     RMS occupancy error         =   3.9787E-10
     [H,K] commutator            =   2.1242E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0130E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.57475602122984E+01 Eh
   Predicted gain in energy  =      -6.19573937830253E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.574399642533E+01     1.2967E-02     1.0806E-02
    2        -4.575540360575E+01     3.5699E-03     2.9749E-03    -1.1407E-02
    3        -4.575626840156E+01     1.2951E-03     1.0793E-03    -8.6480E-04
    4        -4.575650761325E+01     4.9302E-04     4.1085E-04    -2.3921E-04
    5        -4.575653367042E+01     1.3130E-04     1.0942E-04    -2.6057E-05
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.57565336704209E+01  Eh
     Estimated bandgap           =   1.3294E-01  Eh
     RMS occupancy error         =   6.3360E-10
     [H,K] commutator            =   1.0942E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0401E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58457118395840E+01 Eh
   Predicted gain in energy  =      -8.91781691631195E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.584572684612E+01     7.3789E-03     6.1491E-03
    2        -4.584869216413E+01     1.6343E-03     1.3620E-03    -2.9653E-03
    3        -4.584892394973E+01     4.9896E-04     4.1580E-04    -2.3179E-04
    4        -4.584896286844E+01     1.8901E-04     1.5751E-04    -3.8919E-05
    5        -4.584896663573E+01     4.1468E-05     3.4557E-05    -3.7673E-06
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58489666357344E+01  Eh
     Estimated bandgap           =   1.3211E-01  Eh
     RMS occupancy error         =   1.5687E-11
     [H,K] commutator            =   3.4557E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.0658E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58689382103084E+01 Eh
   Predicted gain in energy  =      -1.99715745739795E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.586886839948E+01     2.8146E-03     2.3455E-03
    2        -4.586934997890E+01     7.7287E-04     6.4405E-04    -4.8158E-04
    3        -4.586939786802E+01     1.4435E-04     1.2029E-04    -4.7889E-05
    4        -4.586940085013E+01     6.5614E-05     5.4678E-05    -2.9821E-06
    5        -4.586940140562E+01     1.8246E-05     1.5205E-05    -5.5549E-07
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58694014056180E+01  Eh
     Estimated bandgap           =   1.2944E-01  Eh
     RMS occupancy error         =   4.5938E-13
     [H,K] commutator            =   1.5205E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7434E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58756220614846E+01 Eh
   Predicted gain in energy  =      -6.22065586658493E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587562098053E+01     1.6785E-03     1.3987E-03
    2        -4.587579757885E+01     4.6203E-04     3.8503E-04    -1.7660E-04
    3        -4.587581540700E+01     8.6000E-05     7.1667E-05    -1.7828E-05
    4        -4.587581648010E+01     4.2100E-05     3.5084E-05    -1.0731E-06
    5        -4.587581675683E+01     1.5658E-05     1.3048E-05    -2.7673E-07
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58758167568298E+01  Eh
     Estimated bandgap           =   1.2760E-01  Eh
     RMS occupancy error         =   1.2788E-13
     [H,K] commutator            =   1.3048E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4284E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58772421796231E+01 Eh
   Predicted gain in energy  =      -1.42542279326108E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587724189615E+01     2.1116E-04     1.7597E-04
    2        -4.587724671756E+01     5.1229E-05     4.2691E-05    -4.8214E-06
    3        -4.587724707144E+01     3.4517E-05     2.8764E-05    -3.5388E-07
    4        -4.587724718515E+01     1.5347E-05     1.2790E-05    -1.1371E-07
    5        -4.587724721501E+01     6.3923E-06     5.3269E-06    -2.9866E-08
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58772472150114E+01  Eh
     Estimated bandgap           =   1.2630E-01  Eh
     RMS occupancy error         =   2.9446E-15
     [H,K] commutator            =   5.3269E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.3724E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58781265128273E+01 Eh
   Predicted gain in energy  =      -8.79297815906455E-04 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587812443040E+01     4.3154E-04     3.5962E-04
    2        -4.587813962693E+01     1.7205E-04     1.4338E-04    -1.5197E-05
    3        -4.587814229973E+01     6.0017E-05     5.0015E-05    -2.6728E-06
    4        -4.587814290364E+01     2.6137E-05     2.1781E-05    -6.0390E-07
    5        -4.587814300146E+01     1.0623E-05     8.8527E-06    -9.7820E-08
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58781430014560E+01  Eh
     Estimated bandgap           =   1.2425E-01  Eh
     RMS occupancy error         =   2.4119E-14
     [H,K] commutator            =   8.8527E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.5232E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58785161214447E+01 Eh
   Predicted gain in energy  =      -3.73119988758219E-04 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587851272028E+01     4.2649E-04     3.5541E-04
    2        -4.587852629531E+01     1.5402E-04     1.2835E-04    -1.3575E-05
    3        -4.587852871557E+01     4.8758E-05     4.0632E-05    -2.4203E-06
    4        -4.587852914072E+01     2.0871E-05     1.7392E-05    -4.2515E-07
    5        -4.587852921079E+01     8.8333E-06     7.3611E-06    -7.0073E-08
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58785292107906E+01  Eh
     Estimated bandgap           =   1.2445E-01  Eh
     RMS occupancy error         =   1.1264E-14
     [H,K] commutator            =   7.3611E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5436E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58786336420748E+01 Eh
   Predicted gain in energy  =      -1.04431284121631E-04 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587863148562E+01     3.1092E-04     2.5910E-04
    2        -4.587863826268E+01     9.8766E-05     8.2305E-05    -6.7771E-06
    3        -4.587863940143E+01     3.0886E-05     2.5739E-05    -1.1387E-06
    4        -4.587863956570E+01     1.3875E-05     1.1563E-05    -1.6427E-07
    5        -4.587863959804E+01     6.0910E-06     5.0759E-06    -3.2341E-08
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58786395980413E+01  Eh
     Estimated bandgap           =   1.2174E-01  Eh
     RMS occupancy error         =   2.2671E-15
     [H,K] commutator            =   5.0759E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1401E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58786768658032E+01 Eh
   Predicted gain in energy  =      -3.72677619466799E-05 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587867601732E+01     1.0232E-04     8.5265E-05
    2        -4.587867699799E+01     4.5247E-05     3.7706E-05    -9.8067E-07
    3        -4.587867721263E+01     1.7986E-05     1.4988E-05    -2.1464E-07
    4        -4.587867725836E+01     8.6580E-06     7.2150E-06    -4.5729E-08
    5        -4.587867727043E+01     3.0850E-06     2.5708E-06    -1.2067E-08
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58786772704268E+01  Eh
     Estimated bandgap           =   1.2116E-01  Eh
     RMS occupancy error         =   3.6158E-16
     [H,K] commutator            =   2.5708E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4730E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58786775638143E+01 Eh
   Predicted gain in energy  =      -2.93387529382017E-07 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587867755064E+01     1.1710E-05     9.7583E-06
    2        -4.587867756360E+01     5.2542E-06     4.3785E-06    -1.2965E-08
    3        -4.587867756650E+01     2.2533E-06     1.8777E-06    -2.8978E-09
    4        -4.587867756739E+01     1.0828E-06     9.0233E-07    -8.8662E-10
    5        -4.587867756755E+01     3.6518E-07     3.0431E-07    -1.6376E-10
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58786775675507E+01  Eh
     Estimated bandgap           =   1.2109E-01  Eh
     RMS occupancy error         =   1.7174E-16
     [H,K] commutator            =   3.0431E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8638E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58786776648867E+01 Eh
   Predicted gain in energy  =      -9.73360343436980E-08 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587867765949E+01     7.3477E-06     6.1231E-06
    2        -4.587867766458E+01     3.2492E-06     2.7077E-06    -5.0821E-09
    3        -4.587867766568E+01     1.2290E-06     1.0242E-06    -1.1001E-09
    4        -4.587867766587E+01     5.5723E-07     4.6436E-07    -1.9573E-10
    5        -4.587867766592E+01     2.3473E-07     1.9561E-07    -4.9909E-11
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58786776659226E+01  Eh
     Estimated bandgap           =   1.2122E-01  Eh
     RMS occupancy error         =   1.9596E-16
     [H,K] commutator            =   1.9561E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0311E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.58786776780758E+01 Eh
   Predicted gain in energy  =      -1.21531442687228E-08 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.587867767753E+01     2.4151E-06     2.0126E-06
    2        -4.587867767808E+01     1.0625E-06     8.8539E-07    -5.4260E-10
    3        -4.587867767819E+01     3.8971E-07     3.2476E-07    -1.1678E-10
    4        -4.587867767821E+01     1.8610E-07     1.5508E-07    -2.0172E-11
    5        -4.587867767821E+01     8.9959E-08     7.4965E-08    -1.6129E-12
Finished density kernel iterations (   5)

Writing density kernel to file "formaldehyde_dimer.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.58786776782142E+01  Eh
     Estimated bandgap           =   1.2284E-01  Eh
     RMS occupancy error         =   1.4186E-16
     [H,K] commutator            =   7.4965E-08
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000050225790              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       31.98812490097340 |
           | Pseudopotential (local)    :     -192.04416616464985 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        4.97861279673193 |
           | Hartree                    :       79.12890293875650 |
           | Exchange-correlation       :      -12.46365035273461 |
           | Ewald                      :       42.53349820270844 |
           | Total                      :      -45.87867767821420 |
           --------------------------------------------------------
           Integrated density           :       23.99999999997143
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00301297256481    -45.12798627446818   0.597584    -45.74756021229843        
   1     0.00104008697362    -45.75653367042086   0.711880    -45.84571183958398        
   2     0.00050657745561    -45.84896663573444   0.655278    -45.86893821030842        
   3     0.00027434111567    -45.86940140561805   0.705914    -45.87562206148463        
   4     0.00014284184236    -45.87581675682984   0.611686    -45.87724217962310        
   5     0.00009372419069    -45.87724721501143   0.873612    -45.87812651282734        
   6     0.00006523195618    -45.87814300145596   0.754267    -45.87851612144472        
   7     0.00003543613137    -45.87852921079063   0.703771    -45.87863364207475        
   8     0.00002140099690    -45.87863959804126   0.712461    -45.87867686580321        
   9     0.00000547304356    -45.87867727042678   0.084829    -45.87867756381431        
  10     0.00000386376209    -45.87867756755065   0.057089    -45.87867766488669        
  11     0.00000303108860    -45.87867766592264   0.011708    -45.87867767807578        
  12     0.00000050225790    -45.87867767821422  <-- CG                                 

======================== Writing density and potential =========================
Writing "formaldehyde_dimer_density.cube" ... done
Writing "formaldehyde_dimer_potential.cube" ... done
Writing "formaldehyde_dimer_electrostatic_potential.cube" ... done
================================================================================

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  C      1       4.027     -0.027
  C      2       4.027     -0.027
  O      3       6.458     -0.458
  O      4       6.458     -0.458
  H      5       0.758      0.242
  H      6       0.758      0.242
  H      7       0.758      0.242
  H      8       0.758      0.242
==================================

        Bond         Population      Length (bohr)
==================================================
 C     2 -- H     6        0.73      2.06152
 C     1 -- H     5        0.73      2.06152
 C     1 -- H     7        0.73      2.06152
 C     2 -- H     8        0.73      2.06152
 C     1 -- O     3        0.95      2.24428
 C     2 -- O     4        0.95      2.24428
 H     6 -- H     8       -0.23      3.49562
 H     5 -- H     7       -0.23      3.49562
 O     4 -- H     6       -0.15      3.76741
 O     3 -- H     5       -0.15      3.76741
 O     3 -- H     7       -0.15      3.76741
 O     4 -- H     8       -0.15      3.76741
==================================================


=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      20
   Number of occupied orbitals:      12.000000000
   Occupancy sum (eigenvalues):      12.000000000
                 HOMO-LUMO gap:       0.121117610 Eh
                 Mid-gap level:      -0.160429064 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.010018265   1.0000000
                        .......   ...........   .........
                            3    -0.586332738   1.0000000
                            4    -0.583103693   1.0000000
                            5    -0.452336808   1.0000000
                            6    -0.450168332   1.0000000
                            7    -0.412184216   1.0000000
                            8    -0.411225616   1.0000000
                            9    -0.384619133   1.0000000
                           10    -0.361571622   1.0000000
                           11    -0.222753865   1.0000000
                           12    -0.220987869   1.0000000
                        .......   --- gap ---   .........
                           13    -0.099870259   0.0000000
                           14    -0.068560055   0.0000000
                           15     0.067567503   0.0000000
                           16     0.093728215   0.0000000
                           17     0.171063641   0.0000000
                           18     0.192809713   0.0000000
                           19     0.229050335   0.0000000
                           20     0.269889834   0.0000000

================================================================================

===================== Writing canonical molecular orbitals =====================
| Orbital  Energy (eV)  Norm     |
| HOMO-5  -11.21610323  1.000000 | Writing "formaldehyde_dimer_HOMO-5.cube" ... done
| HOMO-4  -11.19001839  1.000000 | Writing "formaldehyde_dimer_HOMO-4.cube" ... done
| HOMO-3  -10.46601917  1.000000 | Writing "formaldehyde_dimer_HOMO-3.cube" ... done
| HOMO-2   -9.83886447  1.000000 | Writing "formaldehyde_dimer_HOMO-2.cube" ... done
| HOMO-1   -6.06144109  1.000000 | Writing "formaldehyde_dimer_HOMO-1.cube" ... done
| HOMO     -6.01338591  1.000000 | Writing "formaldehyde_dimer_HOMO.cube" ... done
| LUMO     -2.71760803  1.000000 | Writing "formaldehyde_dimer_LUMO.cube" ... done
| LUMO+1   -1.86561403  1.000000 | Writing "formaldehyde_dimer_LUMO+1.cube" ... done
| LUMO+2    1.83860532  1.000000 | Writing "formaldehyde_dimer_LUMO+2.cube" ... done
| LUMO+3    2.55047450  1.000000 | Writing "formaldehyde_dimer_LUMO+3.cube" ... done
| LUMO+4    4.65487854  1.000000 | Writing "formaldehyde_dimer_LUMO+4.cube" ... done
| LUMO+5    5.24661927  1.000000 | Writing "formaldehyde_dimer_LUMO+5.cube" ... done
================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "formaldehyde_dimer_DOS.txt" ...  done
================================================================================
 
Writing bands to file "formaldehyde_dimer.val_bands" ... done

WARNING: read_denskern overridden to T because of task COND.


WARNING: read_tightbox_ngwfs overridden to T because of task COND.


WARNING: lr_tddft_write_kernels overriden to T, as you have requested the output of MO coeffs to be turned on for the interface to TheoDORE.

Determining parallel strategy ...... done
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "formaldehyde_dimer.tightbox_ngwfs" ...  done

Reading density kernel from file "formaldehyde_dimer.dkn" ... done
Conduction NGWF sparse matrix initialisation ... done
Conduction NGWF initialisation ...... done
+------------------------------------------------------------------------------+
|                   Starting conduction NGWF optimisation                      |
+------------------------------------------------------------------------------+
Generating conduction density kernel for     8 'occupied' orbitals
Up spin density kernel initialisation ...... done

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         4.031061903101E+00      6.911E-15      3.470E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000000000      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   4.03106190310146E+00  Eh
     Estimated gap above Kc      =   1.1009E-01  Eh
     RMS occupancy error         =   6.4167E-16
     [H,K] commutator            =   6.9109E-15
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  001 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8627E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       2.55993987409737E+00 Eh
   Predicted gain in energy  =      -1.47112202900410E+00 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         2.549627737855E+00     1.0582E-02     1.3228E-02
    2         2.516282546505E+00     2.2347E-03     2.7933E-03    -3.3345E-02
    3         2.515320119996E+00     5.2823E-04     6.6028E-04    -9.6243E-04
    4         2.515262116594E+00     1.3496E-04     1.6871E-04    -5.8003E-05
    5         2.515257916339E+00     1.6496E-05     2.0620E-05    -4.2003E-06
    6         2.515257864738E+00     5.0613E-06     6.3267E-06    -5.1601E-08
    7         2.515257859487E+00     7.9306E-07     9.9133E-07    -5.2507E-09
    8         2.515257859358E+00     2.2214E-07     2.7768E-07    -1.2923E-10
    9         2.515257859347E+00     7.9818E-08     9.9772E-08    -1.1487E-11
   10         2.515257859345E+00     8.7481E-09     1.0935E-08    -1.2150E-12
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   2.51525785934532E+00  Eh
     Estimated gap above Kc      =   2.7257E-01  Eh
     RMS occupancy error         =   4.2129E-16
     [H,K] commutator            =   1.0935E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  002 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7605E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.50666420381024E+00 Eh
   Predicted gain in energy  =      -1.00859365553508E+00 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         1.560552707986E+00     3.4845E-03     4.3557E-03
    2         1.558255454859E+00     7.2071E-04     9.0088E-04    -2.2973E-03
    3         1.558166561640E+00     9.8165E-05     1.2271E-04    -8.8893E-05
    4         1.558164799889E+00     1.1072E-05     1.3840E-05    -1.7618E-06
    5         1.558164776646E+00     2.7284E-06     3.4105E-06    -2.3243E-08
    6         1.558164775302E+00     2.4448E-07     3.0560E-07    -1.3444E-09
    7         1.558164775290E+00     2.7530E-08     3.4413E-08    -1.1566E-11
    8         1.558164775290E+00     5.8815E-09     7.3519E-09    -1.4788E-13
    9         1.558164775290E+00      8.619E-10      1.077E-09     -3.553E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000086192      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.55816477528985E+00  Eh
     Estimated gap above Kc      =   3.7475E-01  Eh
     RMS occupancy error         =   5.3194E-16
     [H,K] commutator            =   1.0774E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  003 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5969E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       8.36453348611139E-01 Eh
   Predicted gain in energy  =      -7.21711426678712E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         9.612667375242E-01     4.7560E-03     5.9455E-03
    2         9.567894718014E-01     4.3294E-04     5.4117E-04    -4.4773E-03
    3         9.567561489390E-01     5.8170E-05     7.2712E-05    -3.3323E-05
    4         9.567556185068E-01     5.9218E-06     7.4023E-06    -5.3043E-07
    5         9.567556120934E-01     6.1847E-07     7.7309E-07    -6.4134E-09
    6         9.567556120300E-01     9.6352E-08     1.2044E-07    -6.3345E-11
    7         9.567556120284E-01     6.0164E-09     7.5205E-09    -1.5945E-12
    8         9.567556120284E-01     1.8107E-09     2.2634E-09    -5.6621E-15
    9         9.567556120284E-01     1.4825E-09     1.8531E-09     6.3283E-15
   10         9.567556120284E-01     1.1417E-09     1.4271E-09    -2.4425E-15
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   9.56755612028410E-01  Eh
     Estimated gap above Kc      =   4.3864E-01  Eh
     RMS occupancy error         =   3.2303E-16
     [H,K] commutator            =   1.4271E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  004 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3271E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       4.54509717714142E-01 Eh
   Predicted gain in energy  =      -5.02245894314268E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         5.941947556290E-01     4.5638E-03     5.7052E-03
    2         5.902131023475E-01     3.2456E-04     4.0569E-04    -3.9817E-03
    3         5.901945544643E-01     3.4899E-05     4.3624E-05    -1.8548E-05
    4         5.901943617689E-01     3.6085E-06     4.5106E-06    -1.9270E-07
    5         5.901943594492E-01     4.1764E-07     5.2205E-07    -2.3197E-09
    6         5.901943594219E-01     4.4376E-08     5.5470E-08    -2.7213E-11
    7         5.901943594216E-01     2.5441E-09     3.1802E-09    -3.2507E-13
    8         5.901943594216E-01      5.170E-10      6.463E-10     -2.109E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000051703      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   5.90194359421617E-01  Eh
     Estimated gap above Kc      =   4.6592E-01  Eh
     RMS occupancy error         =   2.9023E-16
     [H,K] commutator            =   6.4628E-10
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  005 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1958E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       4.07841563891982E-01 Eh
   Predicted gain in energy  =      -1.82352795529635E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         4.099003756356E-01     1.0675E-03     1.3344E-03
    2         4.096935196608E-01     9.9718E-05     1.2465E-04    -2.0686E-04
    3         4.096918708557E-01     1.2626E-05     1.5782E-05    -1.6488E-06
    4         4.096918456456E-01     1.0532E-06     1.3165E-06    -2.5210E-08
    5         4.096918454501E-01     1.0771E-07     1.3464E-07    -1.9550E-10
    6         4.096918454482E-01     1.2420E-08     1.5525E-08    -1.8978E-12
    7         4.096918454482E-01     1.4933E-09     1.8666E-09    -2.6312E-14
    8         4.096918454482E-01     1.3507E-09     1.6883E-09     2.5535E-15
    9         4.096918454482E-01     1.0659E-09     1.3324E-09    -5.5511E-16
   10         4.096918454482E-01      3.227E-10      4.034E-10     -2.665E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000032274      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   4.09691845448166E-01  Eh
     Estimated gap above Kc      =   4.7528E-01  Eh
     RMS occupancy error         =   3.8404E-16
     [H,K] commutator            =   4.0342E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  006 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.9879E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       2.42564140254644E-01 Eh
   Predicted gain in energy  =      -1.67127705193521E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         2.429289233838E-01     2.9660E-03     3.7075E-03
    2         2.412533475294E-01     1.7786E-04     2.2233E-04    -1.6756E-03
    3         2.412478991686E-01     1.8062E-05     2.2577E-05    -5.4484E-06
    4         2.412478481177E-01     1.9961E-06     2.4951E-06    -5.1051E-08
    5         2.412478474208E-01     1.5707E-07     1.9633E-07    -6.9691E-10
    6         2.412478474169E-01     1.4596E-08     1.8245E-08    -3.9390E-12
    7         2.412478474169E-01     2.2008E-09     2.7510E-09    -3.5749E-14
    8         2.412478474169E-01      6.018E-10      7.523E-10     -1.443E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000060181      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   2.41247847416854E-01  Eh
     Estimated gap above Kc      =   4.7427E-01  Eh
     RMS occupancy error         =   2.1041E-16
     [H,K] commutator            =   7.5227E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  007 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.3636E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.28020405568349E-01 Eh
   Predicted gain in energy  =      -1.13227441848505E-01 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         1.302211471440E-01     3.0481E-03     3.8102E-03
    2         1.284360143747E-01     2.2858E-04     2.8573E-04    -1.7851E-03
    3         1.284274214729E-01     2.7407E-05     3.4259E-05    -8.5929E-06
    4         1.284273007535E-01     1.5856E-06     1.9821E-06    -1.2072E-07
    5         1.284273002926E-01     1.3664E-07     1.7080E-07    -4.6089E-10
    6         1.284273002896E-01     1.5361E-08     1.9201E-08    -3.0402E-12
    7         1.284273002895E-01     1.4299E-09     1.7873E-09    -3.8775E-14
    8         1.284273002895E-01      9.294E-10      1.162E-09     -1.305E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000092937      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.28427300289545E-01  Eh
     Estimated gap above Kc      =   4.6325E-01  Eh
     RMS occupancy error         =   2.6298E-16
     [H,K] commutator            =   1.1617E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  008 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.2795E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       4.68307980950843E-02 Eh
   Predicted gain in energy  =      -8.15965021944603E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         5.054722235878E-02     3.4161E-03     4.2701E-03
    2         4.822438130126E-02     2.4795E-04     3.0994E-04    -2.3228E-03
    3         4.821341427036E-02     2.2694E-05     2.8367E-05    -1.0967E-05
    4         4.821333134169E-02     1.6531E-06     2.0664E-06    -8.2929E-08
    5         4.821333090979E-02     1.1660E-07     1.4575E-07    -4.3191E-10
    6         4.821333090759E-02     1.5211E-08     1.9013E-08    -2.1962E-12
    7         4.821333090755E-02     1.6886E-09     2.1107E-09    -3.7359E-14
    8         4.821333090755E-02     1.3364E-09     1.6705E-09     7.9103E-16
    9         4.821333090755E-02      9.134E-10      1.142E-09     -7.910E-16

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000091342      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   4.82133309075537E-02  Eh
     Estimated gap above Kc      =   4.3611E-01  Eh
     RMS occupancy error         =   2.3433E-16
     [H,K] commutator            =   1.1418E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  009 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9937E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =       1.09088612207136E-02 Eh
   Predicted gain in energy  =      -3.73044696868401E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1         1.100885543895E-02     6.2856E-04     7.8570E-04
    2         1.093127639443E-02     5.8911E-05     7.3639E-05    -7.7579E-05
    3         1.093066952284E-02     5.7258E-06     7.1573E-06    -6.0687E-07
    4         1.093066404049E-02     4.9847E-07     6.2309E-07    -5.4824E-09
    5         1.093066400033E-02     3.4739E-08     4.3424E-08    -4.0155E-11
    6         1.093066400012E-02     4.8454E-09     6.0567E-09    -2.0606E-13
    7         1.093066400012E-02      9.104E-10      1.138E-09     -4.110E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000091044      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.09306640001206E-02  Eh
     Estimated gap above Kc      =   4.2885E-01  Eh
     RMS occupancy error         =   4.1751E-16
     [H,K] commutator            =   1.1380E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  010 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3171E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.69199828211436E-02 Eh
   Predicted gain in energy  =      -2.78506468212643E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.671348380558E-02     1.5674E-03     1.9592E-03
    2        -1.721432046989E-02     1.4636E-04     1.8296E-04    -5.0084E-04
    3        -1.721819321013E-02     1.6400E-05     2.0501E-05    -3.8727E-06
    4        -1.721823932775E-02     1.7284E-06     2.1604E-06    -4.6118E-08
    5        -1.721823981779E-02     1.8338E-07     2.2923E-07    -4.9004E-10
    6        -1.721823982426E-02     2.6883E-08     3.3603E-08    -6.4692E-12
    7        -1.721823982438E-02     3.1975E-09     3.9969E-09    -1.1931E-13
    8        -1.721823982438E-02     1.0654E-09     1.3318E-09    -2.2204E-16
    9        -1.721823982438E-02      5.182E-10      6.477E-10     -2.387E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000051815      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.72182398243802E-02  Eh
     Estimated gap above Kc      =   4.0335E-01  Eh
     RMS occupancy error         =   1.8046E-16
     [H,K] commutator            =   6.4769E-10
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  011 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6355E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -3.49818783345173E-02 Eh
   Predicted gain in energy  =      -1.77636385101371E-02 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -3.464082822826E-02     1.8590E-03     2.3237E-03
    2        -3.539048108038E-02     1.7792E-04     2.2241E-04    -7.4965E-04
    3        -3.539654796647E-02     1.9515E-05     2.4394E-05    -6.0669E-06
    4        -3.539662080605E-02     2.1451E-06     2.6813E-06    -7.2840E-08
    5        -3.539662165247E-02     4.0417E-07     5.0522E-07    -8.4643E-10
    6        -3.539662168249E-02     6.4960E-08     8.1200E-08    -3.0013E-11
    7        -3.539662168321E-02     6.9109E-09     8.6386E-09    -7.2624E-13
    8        -3.539662168322E-02     1.4074E-09     1.7592E-09    -7.7577E-15
    9        -3.539662168322E-02     1.0923E-09     1.3654E-09    -1.3739E-15
   10        -3.539662168322E-02     1.0430E-09     1.3038E-09     3.7331E-15
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.53966216832185E-02  Eh
     Estimated gap above Kc      =   3.6554E-01  Eh
     RMS occupancy error         =   1.5693E-16
     [H,K] commutator            =   1.3038E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  012 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8638E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -4.28397485201084E-02 Eh
   Predicted gain in energy  =      -7.44312683688991E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -4.264965865751E-02     1.4120E-03     1.7650E-03
    2        -4.310529035944E-02     1.5341E-04     1.9176E-04    -4.5563E-04
    3        -4.310985733620E-02     2.1763E-05     2.7204E-05    -4.5670E-06
    4        -4.310994656398E-02     3.8965E-06     4.8707E-06    -8.9228E-08
    5        -4.310994935452E-02     6.1671E-07     7.7089E-07    -2.7905E-09
    6        -4.310994943479E-02     1.1645E-07     1.4557E-07    -8.0275E-11
    7        -4.310994943724E-02     1.4001E-08     1.7502E-08    -2.4440E-12
    8        -4.310994943727E-02     2.4963E-09     3.1204E-09    -2.9865E-14
    9        -4.310994943727E-02      4.920E-10      6.150E-10      3.331E-16

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000049199      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -4.31099494372664E-02  Eh
     Estimated gap above Kc      =   3.3054E-01  Eh
     RMS occupancy error         =   2.0250E-16
     [H,K] commutator            =   6.1499E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  013 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7997E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.12878969767752E-02 Eh
   Predicted gain in energy  =      -8.17794753950879E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -5.123547991920E-02     8.3393E-04     1.0424E-03
    2        -5.139850180548E-02     1.0252E-04     1.2815E-04    -1.6302E-04
    3        -5.140055325208E-02     1.5419E-05     1.9273E-05    -2.0514E-06
    4        -5.140059931588E-02     3.0031E-06     3.7538E-06    -4.6064E-08
    5        -5.140060099979E-02     4.5005E-07     5.6256E-07    -1.6839E-09
    6        -5.140060104351E-02     1.0750E-07     1.3438E-07    -4.3720E-11
    7        -5.140060104570E-02     1.7749E-08     2.2186E-08    -2.1860E-12
    8        -5.140060104575E-02     3.5290E-09     4.4112E-09    -5.3783E-14
    9        -5.140060104575E-02      7.767E-10      9.708E-10     -2.595E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000077666      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -5.14006010457518E-02  Eh
     Estimated gap above Kc      =   3.0779E-01  Eh
     RMS occupancy error         =   2.7922E-16
     [H,K] commutator            =   9.7083E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  014 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7528E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -5.94165319051115E-02 Eh
   Predicted gain in energy  =      -8.01593085935969E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -5.922541670537E-02     1.5383E-03     1.9229E-03
    2        -5.982855931837E-02     2.6285E-04     3.2856E-04    -6.0314E-04
    3        -5.984219676802E-02     3.8060E-05     4.7575E-05    -1.3637E-05
    4        -5.984249890336E-02     9.4217E-06     1.1777E-05    -3.0214E-07
    5        -5.984251659881E-02     1.7342E-06     2.1677E-06    -1.7695E-08
    6        -5.984251725223E-02     4.4281E-07     5.5351E-07    -6.5342E-10
    7        -5.984251729637E-02     1.0053E-07     1.2567E-07    -4.4145E-11
    8        -5.984251729807E-02     2.2832E-08     2.8539E-08    -1.6994E-12
    9        -5.984251729817E-02     5.7218E-09     7.1523E-09    -1.0424E-13
   10        -5.984251729818E-02     2.4207E-09     3.0259E-09    -7.9381E-15
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -5.98425172981826E-02  Eh
     Estimated gap above Kc      =   2.6239E-01  Eh
     RMS occupancy error         =   2.7969E-16
     [H,K] commutator            =   3.0259E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  015 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3587E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.38248484482671E-02 Eh
   Predicted gain in energy  =      -3.98233115008444E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.369427407998E-02     1.2974E-03     1.6217E-03
    2        -6.415632381546E-02     2.9380E-04     3.6725E-04    -4.6205E-04
    3        -6.417395031167E-02     4.0470E-05     5.0587E-05    -1.7626E-05
    4        -6.417430914757E-02     1.1191E-05     1.3988E-05    -3.5884E-07
    5        -6.417433626735E-02     2.6250E-06     3.2813E-06    -2.7120E-08
    6        -6.417433774096E-02     6.0132E-07     7.5164E-07    -1.4736E-09
    7        -6.417433783591E-02     1.7868E-07     2.2335E-07    -9.4957E-11
    8        -6.417433784192E-02     5.1001E-08     6.3752E-08    -6.0031E-12
    9        -6.417433784249E-02     1.6824E-08     2.1030E-08    -5.7644E-13
   10        -6.417433784256E-02     3.6386E-09     4.5482E-09    -6.1257E-14
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.41743378425553E-02  Eh
     Estimated gap above Kc      =   2.2469E-01  Eh
     RMS occupancy error         =   2.4675E-16
     [H,K] commutator            =   4.5482E-09
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  016 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.1392E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.63394937517501E-02 Eh
   Predicted gain in energy  =      -2.16515590919480E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.621323879038E-02     1.2508E-03     1.5635E-03
    2        -6.667277400809E-02     3.8925E-04     4.8656E-04    -4.5954E-04
    3        -6.670578086193E-02     5.3778E-05     6.7222E-05    -3.3007E-05
    4        -6.670645392020E-02     1.4995E-05     1.8744E-05    -6.7306E-07
    5        -6.670651002307E-02     4.6667E-06     5.8334E-06    -5.6103E-08
    6        -6.670651466314E-02     9.5921E-07     1.1990E-06    -4.6401E-09
    7        -6.670651488449E-02     3.1719E-07     3.9649E-07    -2.2136E-10
    8        -6.670651490905E-02     1.2500E-07     1.5625E-07    -2.4558E-11
    9        -6.670651491304E-02     3.7646E-08     4.7057E-08    -3.9847E-12
   10        -6.670651491333E-02     9.7396E-09     1.2175E-08    -2.9246E-13
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.67065149133286E-02  Eh
     Estimated gap above Kc      =   1.8885E-01  Eh
     RMS occupancy error         =   2.5545E-16
     [H,K] commutator            =   1.2175E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  017 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.0196E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.81652068284860E-02 Eh
   Predicted gain in energy  =      -1.45869191515746E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.815284473431E-02     4.4467E-04     5.5583E-04
    2        -6.820608573487E-02     1.6526E-04     2.0658E-04    -5.3241E-05
    3        -6.821279516339E-02     2.4708E-05     3.0885E-05    -6.7094E-06
    4        -6.821293935572E-02     6.5568E-06     8.1959E-06    -1.4419E-07
    5        -6.821295088386E-02     2.2573E-06     2.8217E-06    -1.1528E-08
    6        -6.821295200337E-02     5.0295E-07     6.2869E-07    -1.1195E-09
    7        -6.821295205250E-02     1.3873E-07     1.7342E-07    -4.9123E-11
    8        -6.821295205730E-02     6.9828E-08     8.7285E-08    -4.8004E-12
    9        -6.821295205841E-02     1.6947E-08     2.1184E-08    -1.1178E-12
   10        -6.821295205848E-02     5.3621E-09     6.7027E-09    -6.6294E-14
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.82129520584808E-02  Eh
     Estimated gap above Kc      =   1.7728E-01  Eh
     RMS occupancy error         =   2.9573E-16
     [H,K] commutator            =   6.7027E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  018 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.8968E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.93509156563848E-02 Eh
   Predicted gain in energy  =      -1.13796359790400E-03 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.930387035775E-02     8.9488E-04     1.1186E-03
    2        -6.952298242197E-02     3.8204E-04     4.7756E-04    -2.1911E-04
    3        -6.956295669322E-02     6.9390E-05     8.6737E-05    -3.9974E-05
    4        -6.956413981244E-02     1.9813E-05     2.4766E-05    -1.1831E-06
    5        -6.956425165801E-02     8.1227E-06     1.0153E-05    -1.1185E-07
    6        -6.956426787534E-02     2.1689E-06     2.7112E-06    -1.6217E-08
    7        -6.956426873725E-02     3.8461E-07     4.8077E-07    -8.6192E-10
    8        -6.956426877169E-02     1.8175E-07     2.2718E-07    -3.4436E-11
    9        -6.956426878036E-02     5.7325E-08     7.1657E-08    -8.6678E-12
   10        -6.956426878112E-02     2.0707E-08     2.5884E-08    -7.5960E-13
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.95642687811180E-02  Eh
     Estimated gap above Kc      =   1.5554E-01  Eh
     RMS occupancy error         =   2.8277E-16
     [H,K] commutator            =   2.5884E-08
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  019 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5249E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.95959596873634E-02 Eh
   Predicted gain in energy  =      -3.16909062454129E-05 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.959520414001E-02     1.2977E-04     1.6222E-04
    2        -6.959946684277E-02     5.3476E-05     6.6845E-05    -4.2627E-06
    3        -6.960031950120E-02     1.1242E-05     1.4052E-05    -8.5266E-07
    4        -6.960035041708E-02     3.0819E-06     3.8523E-06    -3.0916E-08
    5        -6.960035301171E-02     1.2883E-06     1.6104E-06    -2.5946E-09
    6        -6.960035344560E-02     3.7798E-07     4.7247E-07    -4.3389E-10
    7        -6.960035347194E-02     5.7846E-08     7.2307E-08    -2.6332E-11
    8        -6.960035347265E-02     2.5526E-08     3.1907E-08    -7.1571E-13
    9        -6.960035347285E-02     9.2690E-09     1.1586E-08    -1.9519E-13
   10        -6.960035347286E-02     2.6426E-09     3.3032E-09    -1.6986E-14
Finished density kernel iterations (  10)

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96003534728641E-02  Eh
     Estimated gap above Kc      =   1.5290E-01  Eh
     RMS occupancy error         =   3.5183E-16
     [H,K] commutator            =   3.3032E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  020 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.2965E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.96004498228428E-02 Eh
   Predicted gain in energy  =      -9.63499787315358E-08 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.960044730780E-02     8.0511E-06     1.0064E-05
    2        -6.960046333694E-02     3.2506E-06     4.0633E-06    -1.6029E-08
    3        -6.960046655342E-02     7.0628E-07     8.8285E-07    -3.2165E-09
    4        -6.960046667526E-02     1.9180E-07     2.3976E-07    -1.2185E-10
    5        -6.960046668517E-02     8.0101E-08     1.0013E-07    -9.9011E-12
    6        -6.960046668686E-02     2.4423E-08     3.0529E-08    -1.6914E-12
    7        -6.960046668697E-02     3.6565E-09     4.5706E-09    -1.1088E-13
    8        -6.960046668697E-02     1.5243E-09     1.9054E-09    -2.5674E-15
    9        -6.960046668697E-02     1.2113E-09     1.5141E-09     9.0206E-16
   10        -6.960046668697E-02      6.205E-10      7.756E-10     -2.248E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000062048      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96004666869720E-02  Eh
     Estimated gap above Kc      =   1.5274E-01  Eh
     RMS occupancy error         =   2.6048E-16
     [H,K] commutator            =   7.7560E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  021 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7201E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.96004868176780E-02 Eh
   Predicted gain in energy  =      -2.01307059771727E-08 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.960048627051E-02     3.7729E-06     4.7161E-06
    2        -6.960048978504E-02     1.5215E-06     1.9019E-06    -3.5145E-09
    3        -6.960049049095E-02     3.3148E-07     4.1435E-07    -7.0591E-10
    4        -6.960049051779E-02     9.0053E-08     1.1257E-07    -2.6840E-11
    5        -6.960049051997E-02     3.7622E-08     4.7027E-08    -2.1790E-12
    6        -6.960049052034E-02     1.1552E-08     1.4439E-08    -3.7305E-13
    7        -6.960049052037E-02     1.7492E-09     2.1864E-09    -2.2995E-14
    8        -6.960049052037E-02      7.656E-10      9.570E-10     -2.470E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000076558      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96004905203688E-02  Eh
     Estimated gap above Kc      =   1.5267E-01  Eh
     RMS occupancy error         =   2.1060E-16
     [H,K] commutator            =   9.5698E-10
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  022 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8387E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.96004943833893E-02 Eh
   Predicted gain in energy  =      -3.86302047294951E-09 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.960049427740E-02     1.6618E-06     2.0773E-06
    2        -6.960049495925E-02     6.7027E-07     8.3784E-07    -6.8185E-10
    3        -6.960049509627E-02     1.4606E-07     1.8257E-07    -1.3702E-10
    4        -6.960049510149E-02     3.9700E-08     4.9625E-08    -5.2155E-12
    5        -6.960049510191E-02     1.6516E-08     2.0645E-08    -4.2179E-13
    6        -6.960049510198E-02     4.9737E-09     6.2171E-09    -7.1693E-14
    7        -6.960049510199E-02     1.5917E-09     1.9896E-09    -4.4409E-15
    8        -6.960049510199E-02      4.492E-10      5.615E-10     -1.735E-15

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000044921      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96004951019879E-02  Eh
     Estimated gap above Kc      =   1.5264E-01  Eh
     RMS occupancy error         =   3.3565E-16
     [H,K] commutator            =   5.6151E-10
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  023 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3704E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.96004962386536E-02 Eh
   Predicted gain in energy  =      -1.13666571988080E-09 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.960049620728E-02     9.0445E-07     1.1306E-06
    2        -6.960049640924E-02     3.6482E-07     4.5602E-07    -2.0196E-10
    3        -6.960049644984E-02     7.9486E-08     9.9357E-08    -4.0600E-11
    4        -6.960049645138E-02     2.1570E-08     2.6963E-08    -1.5450E-12
    5        -6.960049645151E-02     8.7991E-09     1.0999E-08    -1.2265E-13
    6        -6.960049645153E-02     2.7655E-09     3.4569E-09    -2.0955E-14
    7        -6.960049645153E-02     2.3176E-09     2.8970E-09    -2.0678E-15
    8        -6.960049645153E-02      6.735E-10      8.418E-10     -3.192E-16

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000067346      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96004964515297E-02  Eh
     Estimated gap above Kc      =   1.5263E-01  Eh
     RMS occupancy error         =   2.4629E-16
     [H,K] commutator            =   8.4182E-10
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  024 ##########################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0787E-06 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -6.96004968934285E-02 Eh
   Predicted gain in energy  =      -4.41898781455841E-10 Eh
  ========================================================================

Writing NGWFs to file "formaldehyde_dimer.tightbox_ngwfs_cond"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -6.960049688123E-02     5.6517E-07     7.0646E-07
    2        -6.960049696009E-02     2.2800E-07     2.8500E-07    -7.8859E-11
    3        -6.960049697595E-02     4.9708E-08     6.2135E-08    -1.5855E-11
    4        -6.960049697655E-02     1.3632E-08     1.7040E-08    -6.0602E-13
    5        -6.960049697660E-02     5.5391E-09     6.9239E-09    -4.7365E-14
    6        -6.960049697661E-02     2.7121E-09     3.3901E-09    -8.9095E-15
    7        -6.960049697661E-02      9.338E-10      1.167E-09     -1.249E-16

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000000093379      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.96004969766093E-02  Eh
     Estimated gap above Kc      =   1.5408E-01  Eh
     RMS occupancy error         =   3.3817E-16
     [H,K] commutator            =   1.1672E-09
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  025 ##########################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000187645405              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00286271203663      4.03106190310146   0.804748      2.55993987409737        
   1     0.00176052701304      2.51525785934532   1.395729      1.50666420381024        
   2     0.00159691592933      1.55816477528985   1.276366      0.83645334861114        
   3     0.00132710667479      0.95675561202841   1.373692      0.45450971771414        
   4     0.00119577857056      0.59019435942162   0.571712      0.40784156389198        
   5     0.00069879434473      0.40969184544817   1.545640      0.24256414025464        
   6     0.00063635585513      0.24124784741685   1.240815      0.12802040556835        
   7     0.00052794627595      0.12842730028954   1.303049      0.04683079809508        
   8     0.00049936746205      0.04821333090755   0.670636      0.01090886122071        
   9     0.00033171033100      0.01093066400012   1.134452     -0.01691998282114        
  10     0.00026354788777     -0.01721823982438   1.132920     -0.03498187833452        
  11     0.00018638306066     -0.03539662168322   0.938948     -0.04283974852011        
  12     0.00017996769362     -0.04310994943727   1.131936     -0.05128789697678        
  13     0.00017527995015     -0.05140060104575   1.153620     -0.05941653190511        
  14     0.00013586685845     -0.05984251729818   0.919122     -0.06382484844827        
  15     0.00009139178089     -0.06417433784256   1.067454     -0.06633949375175        
  16     0.00009019555278     -0.06670651491333   0.803822     -0.06816520682849        
  17     0.00006896843042     -0.06821295205848   1.038092     -0.06935091565638        
  18     0.00002524928494     -0.06956426878112   0.187083     -0.06959595968736        
  19     0.00000529650940     -0.06960035347286   0.013216     -0.06960044982284        
  20     0.00000372009846     -0.06960046668697   0.006521     -0.06960048681768        
  21     0.00000283865206     -0.06960049052037   0.001815     -0.06960049438339        
  22     0.00000237041774     -0.06960049510199   0.000743     -0.06960049623865        
  23     0.00000207867812     -0.06960049645153   0.000373     -0.06960049689343        
  24     0.00000187645405     -0.06960049697661  <-- CG                                 
+------------------------------------------------------------------------------+
|                    Conduction NGWF optimisation complete                     |
+------------------------------------------------------------------------------+

+------------------------------------------------------------------------------+
|                  Starting conduction properties calculation                  |
+------------------------------------------------------------------------------+

======================== Writing density and potential =========================
Writing "formaldehyde_dimer_density.cube" ... done
Writing "formaldehyde_dimer_potential.cube" ... done
Writing "formaldehyde_dimer_electrostatic_potential.cube" ... done
================================================================================

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  C      1       4.027     -0.027
  C      2       4.027     -0.027
  O      3       6.458     -0.458
  O      4       6.458     -0.458
  H      5       0.758      0.242
  H      6       0.758      0.242
  H      7       0.758      0.242
  H      8       0.758      0.242
==================================

        Bond         Population      Length (bohr)
==================================================
 C     2 -- H     6        0.73      2.06152
 C     1 -- H     5        0.73      2.06152
 C     1 -- H     7        0.73      2.06152
 C     2 -- H     8        0.73      2.06152
 C     1 -- O     3        0.95      2.24428
 C     2 -- O     4        0.95      2.24428
 H     6 -- H     8       -0.23      3.49562
 H     5 -- H     7       -0.23      3.49562
 O     4 -- H     6       -0.15      3.76741
 O     3 -- H     5       -0.15      3.76741
 O     3 -- H     7       -0.15      3.76741
 O     4 -- H     8       -0.15      3.76741
==================================================




=========================== Valence diagonalisation ============================

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      20
   Number of occupied orbitals:      12.000000000
   Occupancy sum (eigenvalues):      12.000000000
                 HOMO-LUMO gap:       0.121117610 Eh
                 Mid-gap level:      -0.160429064 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.010018265   1.0000000
                        .......   ...........   .........
                            3    -0.586332738   1.0000000
                            4    -0.583103693   1.0000000
                            5    -0.452336808   1.0000000
                            6    -0.450168332   1.0000000
                            7    -0.412184216   1.0000000
                            8    -0.411225616   1.0000000
                            9    -0.384619133   1.0000000
                           10    -0.361571622   1.0000000
                           11    -0.222753865   1.0000000
                           12    -0.220987869   1.0000000
                        .......   --- gap ---   .........
                           13    -0.099870259   0.0000000
                           14    -0.068560055   0.0000000
                           15     0.067567503   0.0000000
                           16     0.093728215   0.0000000
                           17     0.171063641   0.0000000
                           18     0.192809713   0.0000000
                           19     0.229050335   0.0000000
                           20     0.269889834   0.0000000

================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "formaldehyde_dimer_valence_DOS.txt" ...  done
================================================================================
 
Writing bands to file "formaldehyde_dimer.val_bands" ... done

Joint Valence + Conduction NGWF sparse matrix initialisation ... done
Joint Valence + Conduction NGWF initialisation ...... done




================= Joint valence and conduction diagonalisation =================

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      40
   Number of occupied orbitals:      12.000000000
   Occupancy sum (eigenvalues):      12.000000000
 Num of occupied cond orbitals:       8
            Cond Occupancy sum:       8.000000000
                 HOMO-LUMO gap:       0.114258568 Eh
                 Mid-gap level:      -0.163892841 Eh

                        Orbital | Energy (Eh) | Occupancy | Cond Occupancy
                            1    -1.010019603   0.9999988   0.0000174
                        .......   ...........   .........
                            3    -0.586334838   0.9999970   0.0000055
                            4    -0.583105426   0.9999978   0.0000534
                            5    -0.452339412   0.9999968   0.0000095
                            6    -0.450173327   0.9999943   0.0000567
                            7    -0.412185603   0.9999978   0.0000247
                            8    -0.411232125   0.9999909   0.0000121
                            9    -0.384620501   0.9999974   0.0000014
                           10    -0.361582187   0.9999843   0.0002720
                           11    -0.222796966   0.9998920   0.0000647
                           12    -0.221022124   0.9999288   0.0000933
                        .......   --- gap ---   .........
                           13    -0.106763557   0.0000001   0.9998217
                           14    -0.073798648   0.0000003   0.9998122
                           15    -0.019444408   0.0000008   0.9985984
                           16     0.014649196   0.0000025   0.9965159
                           17     0.016943366   0.0000190   0.9989225
                           18     0.023460413   0.0000025   0.9986527
                           19     0.050251698   0.0000271   0.9958778
                           20     0.056028048   0.0000052   0.9890290
                           21     0.089385099   0.0000010   0.0001656
                           22     0.114452156   0.0000010   0.0105839
                        .......   ...........   .........
                           40     0.513380403   0.0000089   0.0005035

================================================================================

===================== Writing canonical molecular orbitals =====================
| Orbital  Energy (eV)  Norm     |
| HOMO-5  -11.21614098  1.000000 | Writing "formaldehyde_dimer_joint_HOMO-5.cube" ... done
| HOMO-4  -11.19019550  1.000000 | Writing "formaldehyde_dimer_joint_HOMO-4.cube" ... done
| HOMO-3  -10.46605637  1.000000 | Writing "formaldehyde_dimer_joint_HOMO-3.cube" ... done
| HOMO-2   -9.83915194  1.000000 | Writing "formaldehyde_dimer_joint_HOMO-2.cube" ... done
| HOMO-1   -6.06261393  1.000000 | Writing "formaldehyde_dimer_joint_HOMO-1.cube" ... done
| HOMO     -6.01431803  1.000000 | Writing "formaldehyde_dimer_joint_HOMO.cube" ... done
| LUMO     -2.90518421  1.000000 | Writing "formaldehyde_dimer_joint_LUMO.cube" ... done
| LUMO+1   -2.00816340  1.000000 | Writing "formaldehyde_dimer_joint_LUMO+1.cube" ... done
| LUMO+2   -0.52910926  1.000000 | Writing "formaldehyde_dimer_joint_LUMO+2.cube" ... done
| LUMO+3    0.39862492  1.000000 | Writing "formaldehyde_dimer_joint_LUMO+3.cube" ... done
| LUMO+4    0.46105245  1.000000 | Writing "formaldehyde_dimer_joint_LUMO+4.cube" ... done
| LUMO+5    0.63839032  1.000000 | Writing "formaldehyde_dimer_joint_LUMO+5.cube" ... done
================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "formaldehyde_dimer_joint_DOS.txt" ...  done
================================================================================
 
Writing bands to file "formaldehyde_dimer.joint_bands" ... done
+------------------------------------------------------------------------------+
|                  Conduction properties calculation complete                  |
+------------------------------------------------------------------------------+

WARNING: cond_read_tightbox_ngwfs overridden to T because of task LR_TDDFT.


WARNING: lr_tddft_write_kernels overriden to T, as you have requested the output of MO coeffs to be turned on for the interface to TheoDORE.

Determining parallel strategy ...... done
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "formaldehyde_dimer.tightbox_ngwfs" ...  done

Reading density kernel from file "formaldehyde_dimer.dkn" ... done
Conduction NGWF sparse matrix initialisation ...
Reading NGWFs from file "formaldehyde_dimer.tightbox_ngwfs_cond" ...  done
...Done
Generating conduction density kernel for     8 'occupied' orbitals
Up spin density kernel initialisation ...... done

Writing density kernel to file "formaldehyde_dimer.dkn_cond" ... done

Joint Valence + Conduction NGWF sparse matrix initialisation ...Joint Valence + Conduction NGWF initialisation ...... done


################################################################################
########################### LR-TDDFT CG optimisation ###########################
################################################################################

################################################################################
######################### LR_TDDFT CG iteration    1 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.2879E-27 ******

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     3.33775370987527        |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    2 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.2879E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008604
      2    0.0000015069
      3    0.0000009814
      4    0.0000015002
      5    0.0000020011
****** Calculated RMS gradient of g_vec. RMS grad =   0.6112E+00 ******
Conjugate gradient coefficient=     0.7522758896
***** Calculated RMS gradient of search direction. RMS grad =   0.6696E+00 *****
****** Line-min: predicted omega=    1.57905331105565 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2259E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     1.65998018911671        |
           |       Change in omega  =    -1.67777352075856        |
           |       RMS gradient     =     0.61123910232410        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    3 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6736E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000014478
      2    0.0000005658
      3    0.0000006530
      4    0.0000014337
      5    0.0000010561
****** Calculated RMS gradient of g_vec. RMS grad =   0.4748E+00 ******
Conjugate gradient coefficient=     0.6861595406
***** Calculated RMS gradient of search direction. RMS grad =   0.6297E+00 *****
****** Line-min: predicted omega=    1.16474372447211 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1529E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     1.20679211747712        |
           |       Change in omega  =    -0.45318807163959        |
           |       RMS gradient     =     0.47482702443301        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    4 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1202E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008087
      2    0.0000005567
      3    0.0000004788
      4    0.0000007353
      5    0.0000007463
****** Calculated RMS gradient of g_vec. RMS grad =   0.3267E+00 ******
Conjugate gradient coefficient=     0.6105620302
***** Calculated RMS gradient of search direction. RMS grad =   0.4088E+00 *****
****** Line-min: predicted omega=    0.92231681530498 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1106E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.91395576251640        |
           |       Change in omega  =    -0.29283635496071        |
           |       RMS gradient     =     0.32668357365474        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    5 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1331E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000005953
      2    0.0000005716
      3    0.0000005080
      4    0.0000006221
      5    0.0000006875
****** Calculated RMS gradient of g_vec. RMS grad =   0.1672E+00 ******
Conjugate gradient coefficient=     0.1641535548
***** Calculated RMS gradient of search direction. RMS grad =   0.1975E+00 *****
****** Line-min: predicted omega=    0.84080724470974 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1329E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.83431977595463        |
           |       Change in omega  =    -0.07963598656178        |
           |       RMS gradient     =     0.16717167568286        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    0  *****

################################################################################
######################### LR_TDDFT CG iteration    6 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1374E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000004877
      2    0.0000009290
      3    0.0000009072
      4    0.0000008617
      5    0.0000004910
****** Calculated RMS gradient of g_vec. RMS grad =   0.1389E+00 ******
Conjugate gradient coefficient=     0.6290218495
***** Calculated RMS gradient of search direction. RMS grad =   0.2086E+00 *****
****** Line-min: predicted omega=    0.79713805722200 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1044E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.79393906832953        |
           |       Change in omega  =    -0.04038070762509        |
           |       RMS gradient     =     0.13893380922635        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    7 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1413E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007632
      2    0.0000006639
      3    0.0000006093
      4    0.0000008796
      5    0.0000005841
****** Calculated RMS gradient of g_vec. RMS grad =   0.8908E-01 ******
Conjugate gradient coefficient=     0.3452043148
***** Calculated RMS gradient of search direction. RMS grad =   0.1315E+00 *****
****** Line-min: predicted omega=    0.76711882106684 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1901E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.76402676131949        |
           |       Change in omega  =    -0.02991230701004        |
           |       RMS gradient     =     0.08907658038884        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    8 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1563E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000004866
      2    0.0000007846
      3    0.0000007998
      4    0.0000005988
      5    0.0000005218
****** Calculated RMS gradient of g_vec. RMS grad =   0.5206E-01 ******
Conjugate gradient coefficient=     0.2303579478
***** Calculated RMS gradient of search direction. RMS grad =   0.6901E-01 *****
****** Line-min: predicted omega=    0.75584601903495 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1680E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75538453522820        |
           |       Change in omega  =    -0.00864222609129        |
           |       RMS gradient     =     0.05206476627374        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration    9 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1593E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007950
      2    0.0000005840
      3    0.0000009893
      4    0.0000007426
      5    0.0000007491
****** Calculated RMS gradient of g_vec. RMS grad =   0.3742E-01 ******
Conjugate gradient coefficient=     0.5946956544
***** Calculated RMS gradient of search direction. RMS grad =   0.6250E-01 *****
****** Line-min: predicted omega=    0.75269076600278 *****
****** Performed line minimisation. Ideal step size Lambda =   0.9382E+00 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75260611590618        |
           |       Change in omega  =    -0.00277841932202        |
           |       RMS gradient     =     0.03742375400232        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   10 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1570E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007632
      2    0.0000007414
      3    0.0000006462
      4    0.0000008060
      5    0.0000008532
****** Calculated RMS gradient of g_vec. RMS grad =   0.1688E-01 ******
Conjugate gradient coefficient=     0.2224254959
***** Calculated RMS gradient of search direction. RMS grad =   0.2575E-01 *****
****** Line-min: predicted omega=    0.75163819147389 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1628E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75159701922918        |
           |       Change in omega  =    -0.00100909667700        |
           |       RMS gradient     =     0.01687802854741        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    0  *****

################################################################################
######################### LR_TDDFT CG iteration   11 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1499E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007237
      2    0.0000007548
      3    0.0000008344
      4    0.0000008719
      5    0.0000006972
****** Calculated RMS gradient of g_vec. RMS grad =   0.8380E-02 ******
Conjugate gradient coefficient=     0.2445804836
***** Calculated RMS gradient of search direction. RMS grad =   0.1226E-01 *****
****** Line-min: predicted omega=    0.75141843337021 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1158E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75141511411340        |
           |       Change in omega  =    -0.00018190511578        |
           |       RMS gradient     =     0.00837992808100        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   12 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1524E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000009224
      2    0.0000007486
      3    0.0000009493
      4    0.0000006978
      5    0.0000007609
****** Calculated RMS gradient of g_vec. RMS grad =   0.5623E-02 ******
Conjugate gradient coefficient=     0.4547069439
***** Calculated RMS gradient of search direction. RMS grad =   0.9015E-02 *****
****** Line-min: predicted omega=    0.75133064628720 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1300E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75132842107047        |
           |       Change in omega  =    -0.00008669304293        |
           |       RMS gradient     =     0.00562306630201        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   13 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1529E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000009678
      2    0.0000008277
      3    0.0000008887
      4    0.0000004943
      5    0.0000005721
****** Calculated RMS gradient of g_vec. RMS grad =   0.3592E-02 ******
Conjugate gradient coefficient=     0.3549281255
***** Calculated RMS gradient of search direction. RMS grad =   0.5561E-02 *****
****** Line-min: predicted omega=    0.75127864656868 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2046E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75127682692363        |
           |       Change in omega  =    -0.00005159414684        |
           |       RMS gradient     =     0.00359183114841        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   14 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1516E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008994
      2    0.0000008292
      3    0.0000008611
      4    0.0000009097
      5    0.0000009680
****** Calculated RMS gradient of g_vec. RMS grad =   0.3416E-02 ******
Conjugate gradient coefficient=     0.9226044969
***** Calculated RMS gradient of search direction. RMS grad =   0.7148E-02 *****
****** Line-min: predicted omega=    0.75121981661107 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2488E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75121468544021        |
           |       Change in omega  =    -0.00006214148342        |
           |       RMS gradient     =     0.00341596982233        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   15 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1546E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008235
      2    0.0000009057
      3    0.0000007206
      4    0.0000008155
      5    0.0000005435
****** Calculated RMS gradient of g_vec. RMS grad =   0.3968E-02 ******
Conjugate gradient coefficient=     1.3207450166
***** Calculated RMS gradient of search direction. RMS grad =   0.1119E-01 *****
****** Line-min: predicted omega=    0.75114919947836 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1993E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75114110685394        |
           |       Change in omega  =    -0.00007357858627        |
           |       RMS gradient     =     0.00396839826700        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    0  *****

################################################################################
######################### LR_TDDFT CG iteration   16 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1521E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007141
      2    0.0000007658
      3    0.0000008125
      4    0.0000009441
      5    0.0000009286
****** Calculated RMS gradient of g_vec. RMS grad =   0.4335E-02 ******
Conjugate gradient coefficient=     1.2943189357
***** Calculated RMS gradient of search direction. RMS grad =   0.1617E-01 *****
****** Line-min: predicted omega=    0.75101861309151 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2800E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75098580352095        |
           |       Change in omega  =    -0.00015530333299        |
           |       RMS gradient     =     0.00433509048860        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   17 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1536E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000006834
      2    0.0000008671
      3    0.0000008611
      4    0.0000008609
      5    0.0000009363
****** Calculated RMS gradient of g_vec. RMS grad =   0.4797E-02 ******
Conjugate gradient coefficient=     1.0339035043
***** Calculated RMS gradient of search direction. RMS grad =   0.1835E-01 *****
****** Line-min: predicted omega=    0.75084966467970 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2472E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75081942256256        |
           |       Change in omega  =    -0.00016638095838        |
           |       RMS gradient     =     0.00479658659179        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   18 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1524E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000006487
      2    0.0000007241
      3    0.0000009220
      4    0.0000007156
      5    0.0000005765
****** Calculated RMS gradient of g_vec. RMS grad =   0.6247E-02 ******
Conjugate gradient coefficient=     1.9343035689
***** Calculated RMS gradient of search direction. RMS grad =   0.3651E-01 *****
****** Line-min: predicted omega=    0.75065882137283 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1582E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75061310714414        |
           |       Change in omega  =    -0.00020631541842        |
           |       RMS gradient     =     0.00624699489015        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   19 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1559E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000006984
      2    0.0000005458
      3    0.0000008288
      4    0.0000009869
      5    0.0000009274
****** Calculated RMS gradient of g_vec. RMS grad =   0.4198E-02 ******
Conjugate gradient coefficient=     0.3626070282
***** Calculated RMS gradient of search direction. RMS grad =   0.1448E-01 *****
****** Line-min: predicted omega=    0.75049731260453 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2403E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75047897305507        |
           |       Change in omega  =    -0.00013413408908        |
           |       RMS gradient     =     0.00419759894544        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   20 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1548E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008403
      2    0.0000006155
      3    0.0000009636
      4    0.0000007310
      5    0.0000004880
****** Calculated RMS gradient of g_vec. RMS grad =   0.2731E-02 ******
Conjugate gradient coefficient=     0.5737452936
***** Calculated RMS gradient of search direction. RMS grad =   0.9411E-02 *****
****** Line-min: predicted omega=    0.75044636441695 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1457E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75044346967140        |
           |       Change in omega  =    -0.00003550338366        |
           |       RMS gradient     =     0.00273060668355        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    0  *****

################################################################################
######################### LR_TDDFT CG iteration   21 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1546E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000005613
      2    0.0000006289
      3    0.0000008127
      4    0.0000008406
      5    0.0000005046
****** Calculated RMS gradient of g_vec. RMS grad =   0.2353E-02 ******
Conjugate gradient coefficient=     0.7868715526
***** Calculated RMS gradient of search direction. RMS grad =   0.8191E-02 *****
****** Line-min: predicted omega=    0.75042533270538 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1271E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75042372805612        |
           |       Change in omega  =    -0.00001974161528        |
           |       RMS gradient     =     0.00235265602839        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   22 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1541E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000004445
      2    0.0000007798
      3    0.0000009445
      4    0.0000005357
      5    0.0000005186
****** Calculated RMS gradient of g_vec. RMS grad =   0.1550E-02 ******
Conjugate gradient coefficient=     0.3699726568
***** Calculated RMS gradient of search direction. RMS grad =   0.3795E-02 *****
****** Line-min: predicted omega=    0.75041246004577 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1868E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75041174433903        |
           |       Change in omega  =    -0.00001198371709        |
           |       RMS gradient     =     0.00154950941272        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   23 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1564E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000006593
      2    0.0000005887
      3    0.0000006278
      4    0.0000005505
      5    0.0000006552
****** Calculated RMS gradient of g_vec. RMS grad =   0.1309E-02 ******
Conjugate gradient coefficient=     0.6925093129
***** Calculated RMS gradient of search direction. RMS grad =   0.3317E-02 *****
****** Line-min: predicted omega=    0.75040556366807 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1506E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75040519363486        |
           |       Change in omega  =    -0.00000655070417        |
           |       RMS gradient     =     0.00130920684078        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   24 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1574E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000007142
      2    0.0000005937
      3    0.0000005591
      4    0.0000009844
      5    0.0000009227
****** Calculated RMS gradient of g_vec. RMS grad =   0.1280E-02 ******
Conjugate gradient coefficient=     0.9235123869
***** Calculated RMS gradient of search direction. RMS grad =   0.3638E-02 *****
****** Line-min: predicted omega=    0.75039838976562 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1792E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75039772230892        |
           |       Change in omega  =    -0.00000747132593        |
           |       RMS gradient     =     0.00128032959531        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   25 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1546E-26 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      1    0.0000008546
      2    0.0000005268
      3    0.0000008962
      4    0.0000005090
      5    0.0000007193
****** Calculated RMS gradient of g_vec. RMS grad =   0.1095E-02 ******
Conjugate gradient coefficient=     0.7771882491
***** Calculated RMS gradient of search direction. RMS grad =   0.3353E-02 *****
****** Line-min: predicted omega=    0.75039108466857 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2057E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75039034016042        |
           |       Change in omega  =    -0.00000738214851        |
           |       RMS gradient     =     0.00109484678068        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    1  *****

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

################################################################################
######################### LR_TDDFT CG iteration   26 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6720E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      2    0.0000005521
      3    0.0000004841
      4    0.0000006259
      5    0.0000006731
****** Calculated RMS gradient of g_vec. RMS grad =   0.1105E-02 ******
Conjugate gradient coefficient=     0.0000026507
***** Calculated RMS gradient of search direction. RMS grad =   0.1354E-02 *****
****** Line-min: predicted omega=    0.75038813356345 *****
****** Performed line minimisation. Ideal step size Lambda =   0.8350E+00 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75038813710792        |
           |       Change in omega  =    -0.00000220305250        |
           |       RMS gradient     =     0.00110523889804        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   27 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6732E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      2    0.0000005738
      3    0.0000004861
      4    0.0000007001
      5    0.0000006408
****** Calculated RMS gradient of g_vec. RMS grad =   0.6659E-03 ******
Conjugate gradient coefficient=     0.2773017902
***** Calculated RMS gradient of search direction. RMS grad =   0.9667E-03 *****
****** Line-min: predicted omega=    0.75038641283660 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2338E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75038642478527        |
           |       Change in omega  =    -0.00000171232265        |
           |       RMS gradient     =     0.00066588808314        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   28 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6700E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      2    0.0000006007
      3    0.0000004359
      4    0.0000005470
      5    0.0000006499
****** Calculated RMS gradient of g_vec. RMS grad =   0.5749E-03 ******
Conjugate gradient coefficient=     0.9280151221
***** Calculated RMS gradient of search direction. RMS grad =   0.1303E-02 *****
****** Line-min: predicted omega=    0.75038455567376 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2723E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75038458144739        |
           |       Change in omega  =    -0.00000184333788        |
           |       RMS gradient     =     0.00057485430460        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   29 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6735E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      2    0.0000006436
      3    0.0000007107
      4    0.0000007941
      5    0.0000009874
****** Calculated RMS gradient of g_vec. RMS grad =   0.7564E-03 ******
Conjugate gradient coefficient=     1.5795542801
***** Calculated RMS gradient of search direction. RMS grad =   0.2368E-02 *****
****** Line-min: predicted omega=    0.75038251700827 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1900E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75038200967837        |
           |       Change in omega  =    -0.00000257176902        |
           |       RMS gradient     =     0.00075641585932        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   30 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.6700E-27 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      2    0.0000006936
      3    0.0000006889
      4    0.0000008772
      5    0.0000006265
****** Calculated RMS gradient of g_vec. RMS grad =   0.8660E-03 ******
Conjugate gradient coefficient=     1.3639212309
***** Calculated RMS gradient of search direction. RMS grad =   0.3533E-02 *****
****** Line-min: predicted omega=    0.75037762113573 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2958E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75037733184512        |
           |       Change in omega  =    -0.00000467783325        |
           |       RMS gradient     =     0.00086603148028        |
           | --> Total change in omega higher than threshold      |
           ========================================================
****** Checking for convergence of individual states *****
****** Number of newly converged states:    3  *****

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

################################################################################
######################### LR_TDDFT CG iteration   31 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1206E-29 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      5    0.0000005219
****** Calculated RMS gradient of g_vec. RMS grad =   0.5390E-03 ******
Conjugate gradient coefficient=     0.0000005168
***** Calculated RMS gradient of search direction. RMS grad =   0.1320E-02 *****
****** Line-min: predicted omega=    0.75037598017086 *****
****** Performed line minimisation. Ideal step size Lambda =   0.2619E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75037590362780        |
           |       Change in omega  =    -0.00000142821732        |
           |       RMS gradient     =     0.00053898089011        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   32 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1559E-29 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      5    0.0000006389
****** Calculated RMS gradient of g_vec. RMS grad =   0.4707E-03 ******
Conjugate gradient coefficient=     0.9712139576
***** Calculated RMS gradient of search direction. RMS grad =   0.2021E-02 *****
****** Line-min: predicted omega=    0.75037491714792 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1967E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation not converged ***         |
           |       LR-TDDFT energy  =     0.75037484594797        |
           |       Change in omega  =    -0.00000105767984        |
           |       RMS gradient     =     0.00047072231384        |
           | --> Total change in omega higher than threshold      |
           ========================================================

################################################################################
######################### LR_TDDFT CG iteration   33 ###########################
****** Initial penalty functional value of K^{1}: Q[K^{1}] =   0.1485E-29 ******
******  Iteratively applying preconditioner on G^{1}: ******
    |STATE|    Final residue  |
      5    0.0000005760
****** Calculated RMS gradient of g_vec. RMS grad =   0.4279E-03 ******
Conjugate gradient coefficient=     0.8551807247
***** Calculated RMS gradient of search direction. RMS grad =   0.2173E-02 *****
****** Line-min: predicted omega=    0.75037421313312 *****
****** Performed line minimisation. Ideal step size Lambda =   0.1475E+01 ******

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

           ........................................................
           |     *** TDDFT optimisation converged ***             |
           |       LR-TDDFT energy  =     0.75037416599327        |
           |       Change in omega  =    -0.00000067995469        |
           |       RMS gradient     =     0.00042790332681        |
           | --> Total change in omega lower than threshold       |
           ========================================================

             |ITER|    Total Energy   |     Penalty value      |     step       
               1    3.3377537099      0.2879312410E-27         0.4318674276
               2    1.6599801891      0.6735612651E-27         2.2586238255
               3    1.2067921175      0.1202262315E-26         1.5290394457
               4    0.9139557625      0.1330960458E-26         1.1058369791
               5    0.8343197760      0.1373985405E-26         1.3289392166
               6    0.7939390683      0.1413100060E-26         1.0442900256
               7    0.7640267613      0.1562610656E-26         1.9014201454
               8    0.7553845352      0.1592669131E-26         1.6802906505
               9    0.7526061159      0.1569618755E-26         0.9381590609
              10    0.7515970192      0.1498890387E-26         1.6276678083
              11    0.7514151141      0.1524191584E-26         1.1577612822
              12    0.7513284211      0.1528863578E-26         1.2996984504
              13    0.7512768269      0.1515995009E-26         2.0463322536
              14    0.7512146854      0.1545685994E-26         2.4881907357
              15    0.7511411069      0.1520990804E-26         1.9933596086
              16    0.7509858035      0.1536368654E-26         2.8002432957
              17    0.7508194226      0.1524397154E-26         2.4721121668
              18    0.7506131071      0.1558536146E-26         1.5821318197
              19    0.7504789731      0.1547985419E-26         2.4033626585
              20    0.7504434697      0.1546360089E-26         1.4569078527
              21    0.7504237281      0.1540588642E-26         1.2713943663
              22    0.7504117443      0.1563598857E-26         1.8678079338
              23    0.7504051936      0.1573935190E-26         1.5055418854
              24    0.7503977223      0.1546444244E-26         1.7915044737
              25    0.7503903402      0.1560509400E-26         2.0574772267
              26    0.7503881371      0.6731953465E-27         0.8350204748
              27    0.7503864248      0.6699995954E-27         2.3382527727
              28    0.7503845814      0.6734863292E-27         2.7228437110
              29    0.7503820097      0.6700321280E-27         1.9004651496
              30    0.7503773318      0.6741559143E-27         2.9577624428
              31    0.7503759036      0.1558884061E-29         2.6192611107
              32    0.7503748459      0.1484708416E-29         1.9669132180
              33    0.7503741660      0.1919260865E-29         1.4745054647

Writing response kernel to file "formaldehyde_dimer_response_denskern_1.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_2.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_3.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_4.dkn" ...
Writing response kernel to file "formaldehyde_dimer_response_denskern_5.dkn" ... done

               |Excitation|    d_x (in D)   |     d_y (in D)  |    d_z (in D)   
                       1    0.30297292E-03    0.10111120E-02   -0.94706784E-02
                       2    0.62064535E-03   -0.46908503E+00   -0.32694804E-01
                       3    0.32615469E-03    0.75863293E+00   -0.13685783E-02
                       4   -0.38833564E-03    0.18185228E-01   -0.19575898E-02
                       5   -0.41430912E-03    0.31102643E+00    0.10017082E-01

   |Excitation|    Energy (in Ha)   |     Oscillator Str.  | Lifetime (in ns)   
           1        0.11884890          0.22274E-05          0.98925E+06
           2        0.12069652          0.55078E-02          0.38790E+03
           3        0.15398345          0.18290E-01          0.71767E+02
           4        0.15529625          0.10727E-04          0.12031E+06
           5        0.20154904          0.40281E-02          0.19021E+03
Writing "formaldehyde_dimer_TDDFT_response_dens_1.cube" ... done
Writing "formaldehyde_dimer_TDDFT_response_dens_2.cube" ... done
Writing "formaldehyde_dimer_TDDFT_response_dens_3.cube" ... done
Writing "formaldehyde_dimer_TDDFT_response_dens_4.cube" ... done
Writing "formaldehyde_dimer_TDDFT_response_dens_5.cube" ... done
Writing "formaldehyde_dimer_TDDFT_hole_dens_1.cube" ... done
Writing "formaldehyde_dimer_TDDFT_elec_dens_1.cube" ... done
Writing "formaldehyde_dimer_TDDFT_hole_dens_2.cube" ... done
Writing "formaldehyde_dimer_TDDFT_elec_dens_2.cube" ... done
Writing "formaldehyde_dimer_TDDFT_hole_dens_3.cube" ... done
Writing "formaldehyde_dimer_TDDFT_elec_dens_3.cube" ... done
Writing "formaldehyde_dimer_TDDFT_hole_dens_4.cube" ... done
Writing "formaldehyde_dimer_TDDFT_elec_dens_4.cube" ... done
Writing "formaldehyde_dimer_TDDFT_hole_dens_5.cube" ... done
Writing "formaldehyde_dimer_TDDFT_elec_dens_5.cube" ... done

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    3168.318s on      2 proc(s)                                    
TOTAL TIME:      3168.319s on      2 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| restart_kernel_read                  :     2        0.00s   0.000%  ------ ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :   609        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    80        0.01s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     3        0.01s   0.000%  ------ ||
|| sparse_init                          :     7        0.01s   0.000%  ------ ||
|| sparse_embed_hotelling_invert_embed  :    80        0.02s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    38        0.03s   0.001%  ------ ||
|| dense_eigensolve                     :     3        0.04s   0.001%  ------ ||
|| restart_kernel_write                 :    41        0.06s   0.002%  ------ ||
|| basis_extract_function_from_box      :   790        0.08s   0.003%  ------ ||
|| lnv_gradient_norm                    :   283        0.10s   0.003%  ------ ||
|| kernel_fix                           :   283        0.13s   0.004%  ------ ||
|| restart_ngwfs_tightbox_input         :     3        0.18s   0.006%  ------ ||
|| restart_response_kernel_batch_write  :    35        0.18s   0.006%  ------ ||
|| kernel_purify                        :   894        0.18s   0.006%  ------ ||
|| sparse_trace                         : 21133        0.26s   0.008%  ------ ||
|| lr_tddft_utils_precond               :   143        0.48s   0.015%  ------ ||
|| pseudo_make_structure_factor         :     3        0.61s   0.019%  ------ ||
|| sparse_product                       : 28407        0.68s   0.021%  ------ ||
|| ngwfs_initialise_from_radial         :     2        0.70s   0.022%  ------ ||
|| pseudopotentials_core_density        :     3        0.76s   0.024%  ------ ||
|| function_ops_brappd_ketppd           :   134        0.77s   0.024%  ------ ||
|| density_init_guess_real              :     1        0.80s   0.025%  ------ ||
|| pseudopotentials_local_on_grid       :     3        0.81s   0.026%  ------ ||
|| restart_ngwfs_tightbox_output        :    36        1.31s   0.041%  ------ ||
|| hamiltonian_energy_components        :     1        3.31s   0.105%  ------ ||
|| projectors_init_fftbox_recip         :   118        9.75s   0.308%  ------ ||
|| optics_pos_mat_els                   :     1       12.67s   0.400%  ------ ||
|| basis_copy_function_to_box           : 10440       12.72s   0.401%  ------ ||
|| density_batch_row_sums               :   458       14.57s   0.460%  ------ ||
|| basis_dot_function_with_box          : 162.8k      14.63s   0.462%  ------ ||
|| cell_grid_extract_box_real           :  4685       15.21s   0.480%  ------ ||
|| eigenstates_calculate                :     3       15.70s   0.495%  ------ ||
|| projectors_func_ovlp_box             :    80       15.70s   0.496%  ------ ||
|| integrals_locpot_mat_els_batch       :   426       15.75s   0.497%  ------ ||
|| basis_add_function_to_box            : 195.0k      18.07s   0.570%  ------ ||
|| integrals_kinetic                    :    80       22.59s   0.713%  ------ ||
|| fourier_apply_box_pair               :  1170       23.32s   0.736%   9.681 ||
|| projectors_gradient_batch            :    38       48.30s   1.524%  ------ ||
|| density_fftbox_deposit_to_cell       :  4580       56.66s   1.788%  ------ ||
|| properties_calculate                 :     3       57.71s   1.821%  ------ ||
|| cell_grid_deposit_box_real           :  4944       58.10s   1.834%  ------ ||
|| hartree_on_grid                      :   436       62.95s   1.987%  ------ ||
|| xc_energy_potential                  :   134      115.56s   3.647%  ------ ||
|| ngwf_gradient_build_batch            :    38      215.77s   6.810%  ------ ||
|| fourier_apply_cell_forward           :  3372      217.14s   6.853%   6.944 ||
|| fourier_apply_cell_backward          :  3378      246.99s   7.796%   6.116 ||
|| ngwf_gradient_batch                  :    38      264.67s   8.354%  ------ ||
|| ngwf_gradient_lnv                    :    38      272.17s   8.590%  ------ ||
|| hamiltonian_lhxc_calculate           :   132      434.03s  13.699%  ------ ||
|| lnv_denskernel_optimise_cg           :    38      525.23s  16.578%  ------ ||
|| xc_fxc_finite_diff                   :   600      558.93s  17.641%  ------ ||
|| density_fftbox_interpolate_multiply  :  4580      885.30s  27.942%  ------ ||
|| potential_apply_to_ngwf_batch        :   426      890.18s  28.096%  ------ ||
|| integrals_locpot_dbl_grid            :   424      907.25s  28.635%  ------ ||
|| density_batch_interp_deposit         :   458      961.87s  30.359%  ------ ||
|| ngwf_cg_optimise                     :     2      984.87s  31.085%  ------ ||
|| density_on_dbl_grid                  :   453     1001.79s  31.619%  ------ ||
|| linear_response_calc_SCF             :   300     1282.33s  40.473%  ------ ||
|| fourier_apply_box                    : 21190     1291.39s  40.759%  15.013 ||
|| linear_response_operator             :  2074     1950.68s  61.568%  ------ ||
|| lr_tddft_cg                          :     1     1951.48s  61.593%  ------ ||
|| lr_tddft_calc_excitations            :     1     2079.34s  65.629%  ------ ||
|| total_time                           :     1     3168.32s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 28-07-2021 18:48 (+0100)

